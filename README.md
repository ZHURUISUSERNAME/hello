# 碳价博弈模型与线性化: 多发电系统场景

考虑一个有三个发电系统参与的碳交易市场。每个系统都有其独特的成本结构和市场需求。

## 1. 模型参数

### 系统 1: 煤电厂
- 初始碳价: $p_1^0 = 10$ €/吨CO₂
- 成本函数: $C_1(p_1) = \frac{p_1}{2}$ €/吨CO₂
- 需求函数: $D_1(p_1) = 100 - 2p_1$ 万吨CO₂

### 系统 2: 天然气发电厂
- 初始碳价: $p_2^0 = 12$ €/吨CO₂
- 成本函数: $C_2(p_2) = \frac{p_2}{3}$ €/吨CO₂
- 需求函数: $D_2(p_2) = 120 - 3p_2$ 万吨CO₂

### 系统 3: 混合可再生能源系统
- 初始碳价: $p_3^0 = 15$ €/吨CO₂
- 成本函数: $C_3(p_3) = \frac{p_3}{4}$ €/吨CO₂
- 需求函数: $D_3(p_3) = 80 - p_3$ 万吨CO₂

## 2. 碳价博弈模型

每个系统 $i$ 的利润函数为:

$$\Pi_i(p_i) = D_i(p_i) \cdot (p_i - C_i(p_i))$$

我们的目标是找到Nash均衡,即所有系统都无法通过单方面改变价格来增加利润的点。这可以通过求解以下优化问题来实现:

$$\min_{p_1, p_2, p_3} -\sum_{i=1}^3 \Pi_i(p_i)$$

subject to $p_i \geq 0$ for $i = 1, 2, 3$

## 3. 求解过程

使用数值优化方法(如SLSQP)求解上述问题,得到均衡碳价 $p_1^*, p_2^*, p_3^*$。

## 4. 碳价线性化

对每个系统,我们将均衡碳价线性化。设定线性化范围因子 $\alpha = 0.2$,则对于系统 $i$:

$$p_i^{min} = p_i^* \cdot (1 - \alpha)$$
$$p_i^{max} = p_i^* \cdot (1 + \alpha)$$

线性化后的碳价函数:

$$p_i(q) = p_i^{min} + (p_i^{max} - p_i^{min}) \cdot \frac{q}{Q_{max}}$$

其中 $q$ 是碳排放量, $Q_{max}$ 是最大考虑的排放量(例如100万吨)。

## 5. 数值结果示例

假设优化后得到的均衡碳价为:
- $p_1^* = 18.5$ €/吨CO₂
- $p_2^* = 20.2$ €/吨CO₂
- $p_3^* = 22.7$ €/吨CO₂

线性化后,对于排放量 $q = 50$ 万吨CO₂:

1. 煤电厂:
   $$p_1(50) = 18.5 \cdot 0.8 + (18.5 \cdot 1.2 - 18.5 \cdot 0.8) \cdot \frac{50}{100} = 18.5 \text{ €/吨CO₂}$$

2. 天然气发电厂:
   $$p_2(50) = 20.2 \cdot 0.8 + (20.2 \cdot 1.2 - 20.2 \cdot 0.8) \cdot \frac{50}{100} = 20.2 \text{ €/吨CO₂}$$

3. 混合可再生能源系统:
   $$p_3(50) = 22.7 \cdot 0.8 + (22.7 \cdot 1.2 - 22.7 \cdot 0.8) \cdot \frac{50}{100} = 22.7 \text{ €/吨CO₂}$$

这个线性化模型允许根据排放量动态调整碳价,同时保持价格在均衡点附近波动。
